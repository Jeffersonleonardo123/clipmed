<%= form_for @agreement ,:html => {:class => "form-horizontal center"}  do |f| %>
  <% if @agreement.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@agreement.errors.count, "error") %> prohibited this client from being saved:</h2>

      <ul>
      <% @agreement.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <%= f.hidden_field :company_id, :value => @agreement.company_id %>
  <div class="col-lg-11">
            <div class="row">
                <div class="form-group">
                    <div class="col-md-2 col-md-offset-1">
                        <label>Nome</label>
                    </div>
                    <div class="col-md-8">
                      <%= f.text_field :name, :class =>"form-control input-sm text-uppercase" %>
                     </div>
                </div>
            </div>

            <div class="row">
              <div class="form-group">
                <div class="col-md-2 col-md-offset-1">
                  <label>Email</label>
                </div>
                <div class="col-md-8">
                  <%= f.text_field :email, :class =>"form-control input-sm text-uppercase" %>
                </div>
              </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <div class="col-md-2 col-md-offset-1">
                        <label>Cnpj</label>
                    </div>
                    <div class="col-md-8">
                        <%= f.text_field :cnpj, :class =>"form-control input-sm", :data=> {:mask=> '99.999.999/9999-99'} %>
                     </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <div class="col-md-2 col-md-offset-1">
                        <label>Fone</label>
                    </div>
                    <div class="col-md-8">
                        <%= f.text_field :fone, :class =>"form-control input-sm",:data=> {:mask=> '(99)99999-9999'} %>
                     </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group">
                    <div class="col-md-2 col-md-offset-1">
                        <label>Cep</label>
                    </div>
                    <div class="col-md-3">
                      <%= f.text_field :zip, :class =>"form-control input-sm",:data=> {:mask=> '99999-999'} %>
                     </div>
                     <div class="col-md-5">
                         <button type="button" name="buttonBuscar" id="buttonBuscar" class="btn btn-success btn-sm">Buscar Endereço</button>
                     </div>
                </div>
            </div>
            <div class="row">
                <div class="form-group">
                    <div class="col-md-2  col-md-offset-1">
                        <label>Endereço</label>
                    </div>
                    <div class="col-md-8">
                        <%= f.text_field :address, :class =>"form-control input-sm"%>
                    </div>
                </div>
            </div>

          <div class="row">
              <div class="form-group">
                  <div class="col-md-2   col-md-offset-1">
                      <label>Numero</label>
                  </div>
                  <div class="col-md-3">
                    <%= f.text_field :number, :class =>"form-control input-sm"%>
                  </div>
              </div>
          </div>

          <div class="row">
              <div class="form-group">
                  <div class="col-md-2   col-md-offset-1">
                      <label>Bairro</label>
                  </div>
                  <div class="col-md-8">
                    <%= f.text_field :neighborhood, :class =>"form-control input-sm"%>
                  </div>
              </div>
          </div>

          <div class="row">
              <div class="form-group">
                  <div class="col-md-2  col-md-offset-1">
                      <label>Cidade</label>
                  </div>
                  <div class="col-md-8">
                    <%= f.text_field :city, :class =>"form-control input-sm"%>
                  </div>
              </div>
          </div>
          <div class="row">
              <div class="form-group">
                  <div class="col-md-2  col-md-offset-1">
                    <label>Estado</label>
                  </div>
                  <div class="col-md-8">
                      <%= f.text_field :state, :class =>"form-control input-sm"%>
                  </div>
              </div>
          </div>
          <div class="row">
              <div class="form-group">
                  <div class="col-md-2 col-md-offset-1">
                      <label>Observação</label>
                  </div>
                  <div class="col-md-8">
                    <%= f.text_area :observation, :class =>"form-control input-sm"%>
                  </div>
              </div>
          </div>
</div>


    <div class="bs-example" data-example-id="block-btns">
        <div class="well center-block" style="max-width:400px">
            <%= f.submit 'Confirmar', :class =>"btn btn-primary btn-block" %>
            <%= link_to 'Cancelar', clients_path,{:class =>"btn btn-danger btn-block"}%>
        </div>
    </div>


<% end %>


<script type="text/javascript" language="javascript">
  $(document).ready(function() {
      $('#buttonBuscar').click(function(){
              var cep = $("#agreement_zip").val().replace(/\D/g, '');
              if (cep != "") {
                  var validacep = /^[0-9]{8}$/;
                  if(validacep.test(cep)) {
                      $.getJSON("//viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {
                          if (!("erro" in dados)) {
                              $("#agreement_address").val(dados.logradouro);
                              $("#agreement_neighborhood").val(dados.bairro);
                              $("#agreement_city").val(dados.localidade);
                              $("#agreement_state").val(dados.uf);
                              $("#agreement_number").focus();
                          }
                          else {
                              alert("CEP não encontrado.");
                          }
                      });
                  }
              }
      });
});


</script>
